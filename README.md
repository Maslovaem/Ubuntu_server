# Проект 4 семестр
 Программное обеспечение для "умного" медицинского сейфа (Маслова Елизавета Б01-303, Горбачев Иван Б01-303)

 # Общий принцип работы
 Данный проект представляет собой сейф для хранения лекарств, использующий базу данных MySQL для хранения информации о пользователях, содержимом ячеек и сроках годности лекарств. Взаимодействие осуществляется путем подключения контроллера ESP32 и компьютера к одной локальной сети. Разворачивается HTML-страница (файл index.html), с которой осуществляется ввод данных о лекарствах (срок годности, штрихкод) и о человеке, который его осуществляет. Чтобы забрать лекарство, пользователь должен нажать кнопку "удалить лекарство" (происходит переход на страницу "delete_form.html"), указать номер ячейки, из которой нужно забрать лекарство, тогда соответствующая запись будет удалена из базы данных. Если при этом какой-то пользователь попробует забрать лекарство без заполнения этой формы, появится pop-up window с уведомлением о том, что была совершена незаконная попытка достать лекарство из ячейки с номером i. Номер ячейки извлекается из json-файла, данные в который парсятся с помощью get_sensors.php, если произошло заметное изменение показаний датчиков. Также есть датчик температуры периодически снимает информацию о температуре окружающей среды и подает сигнал при превышении допустимой для хранения содержимого температуры (текущее значение температуры выводится на экран). Чтобы открыть шкаф, необходимо ввести пароль. Если в базе данных обнаружено просроченное лекарство (сроки годности лекарств отслеживаются с помощью api.php), то светодиод в соответсвующей ячейке мигает. Если затем его извлекут (осознанно удалят из таблицы), то светодиод перестанет мигать.

# Более подробно о реализации
За взаимодействие с датчиками и прочими компонентами системы по локальной сети отвечает программа на C++ (db_mk.ino), загружаемая с помощью Arduino IDE на контроллер. 
Одного ядра не хватает для адекватной работы устройства: процесс снятия показаний с датчиков и их обработки занимает слишком много времени, поэтому если в loop() последовательно добавить код для получения данных с датчика температуры и вывода их на дисплей, мигания светодиодами и обработки данных с уз-датчиков, то промежуток времени между миганиями светодиодов становится слишком длинным. Поэтому было принято решение использовать второе ядро, на которое был добавлен бесконечный цикл, считывающий показания температурного датчика и мигание светодиодом. 

Из библиотеки STL мы используем вектор для хранения номеров светодиодов, соответствующих ячейкам шкафа; вектор удобнее массива в этом плане, потому что синтаксис выглядит проще, а также гораздо удобнее очищать данные (clear) и добавлять новые элементы (push_back). Необходимости в полноценном объектном коде для ESP32 в данном проекте нет; можно добавить больше элементов ООП, но выигрыш не будет столь значителен.
